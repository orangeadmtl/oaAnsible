# MediaMTX Demo Configuration
# Generated by Ansible for {{ inventory_hostname }}

# API settings
api: true
apiAddress: {{ mediamtx_demo.streaming.server_host }}:{{ mediamtx_demo.streaming.api_port }}

# RTSP settings  
rtspAddress: :{{ mediamtx_demo.streaming.rtsp_port }}
rtspEncryption: no
rtspServerKey: server.key
rtspServerCert: server.crt

# Authentication (disabled for demo)
authMethod: internal
authInternalUsers: []

# Path settings
pathDefaults:
  # Source settings
  source: publisher
  sourceProtocol: automatic
  sourceAnyPortEnable: no
  sourceFingerprint:
  sourceOnDemand: no
  sourceOnDemandStartTimeout: 10s
  sourceOnDemandCloseAfter: 10s
  sourceRedirect:

  # Publisher settings  
  disablePublisherOverride: no
  fallback:

  # Authentication
  publishUser:
  publishPass:
  publishIPs: []
  readUser:
  readPass:
  readIPs: []

paths:
  # Main demo camera stream
  {{ mediamtx_demo.streaming.stream_path }}:
    source: publisher
    publishIPs: ["127.0.0.1", "::1", "192.168.0.0/16", "100.0.0.0/8"] # Allow local and Tailscale
    readIPs: [] # Allow all to read for demo
    
  # Test pattern stream for testing
  test:
    source: publisher 
    publishIPs: ["127.0.0.1", "::1"]
    readIPs: []

# Logging
logLevel: info
logDestinations: [stdout]
logFile: {{ mediamtx_demo.storage.logs_dir }}/mediamtx.log